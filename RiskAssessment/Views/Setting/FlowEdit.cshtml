@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{

    ViewData["Title"] = "Create New Flow";
}
<div id="app">
    <div class="pt-3">
        <div class="row pt-5">
            <div class="col pt-2">
                <h3 class=" text-white"><i class="fa-solid fa-gears"></i> @ViewData["Title"]</h3>
            </div>
            <div class="col-auto ml-auto ">
                <a class="btn btn-outline-warning text-white" asp-action="@SettingController.ActionProcessRiskFlow"
                   asp-controller="@SettingController.Name"><i class="fa fa-arrow-circle-left"></i> Back</a>

            </div>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-12">
            <div class="card mt-3">
                <div class="card-body">
                    <div id="stepper3" class="bs-stepper">
                        <div class="bs-stepper-header" role="tablist">
                            <div class="step" data-target="#test-nlf-1">
                                <button type="button" class="step-trigger" role="tab" id="stepper3trigger1" aria-controls="test-nlf-1">
                                    <span class="bs-stepper-circle">
                                        <i class="fa-solid fa-diagram-project"></i>

                                    </span>
                                    <span class="bs-stepper-label">Flow</span>
                                </button>
                            </div>
                            <div class="bs-stepper-line"></div>
                            <div class="step" data-target="#test-nlf-2">
                                <button type="button" class="step-trigger" role="tab" id="stepper3trigger2" aria-controls="test-nlf-2">
                                    <span class="bs-stepper-circle">
                                        <i class="ti-panel"></i>
                                    </span>
                                    <span class="bs-stepper-label">Processes</span>
                                </button>
                            </div>

                            <div class="bs-stepper-line"></div>
                            <div class="step" data-target="#test-nlf-3">
                                <button type="button" class="step-trigger" role="tab" id="stepper3trigger3" aria-controls="test-nlf-3">
                                    <span class="bs-stepper-circle">
                                        <i class="fa-solid fa-floppy-disk"></i>
                                    </span>
                                    <span class="bs-stepper-label">Save</span>
                                </button>
                            </div>
                        </div>
                        <div class="bs-stepper-content">
                            <form onSubmit="return false">
                                <div id="test-nlf-1" role="tabpanel" class="bs-stepper-pane fade" aria-labelledby="stepper3trigger1">
                                    <h5>
                                        Flow Detail
                                    </h5>
                                    <hr />
                                    <div class="row">
                                        <div class="col-6">
                                            <div class="form-group">
                                                <label >Flow Name</label>
                                                <input type="text" class="form-control" id="flowName" placeholder="Enter your flow name" required>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                                <label >Division</label>
                                                <input type="text" class="form-control" readonly value="CE">
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                                <label >Section</label>
                                                <input type="text" class="form-control" readonly value="12AB">
                                            </div>
                                        </div>
                                    </div>

                                    <hr />
                                    <h5>
                                        Process Flow and Interaction.
                                    </h5>
                                    <hr />
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="input-group">
                                                <div class="custom-file">
                                                    <input type="file" class="custom-file-input" id="inputGroupFile04" aria-describedby="inputGroupFileAddon04">
                                                    <label class="custom-file-label" for="inputGroupFile04">Choose file</label>
                                                </div>
                                                @*<div class="input-group-append">
                                                    <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Upload</button>
                                                </div>*@
                                            </div>
                                        </div>
                                        <div class="col-12" id="img_col" style="display:none">
                                            <div class="text-center" style="resize: both;overflow: auto;background-color:darkgray">
                                                <img src="#" id="img_pre" alt="image" style="width:70%">
                                            </div>
                                        </div>
                                    </div>
                                   
                                    
                                </div>
                                <div id="test-nlf-2" role="tabpanel" class="bs-stepper-pane fade" aria-labelledby="stepper3trigger2">
                                    <h5>
                                        Process Identification
                                    </h5>
                                    
                                    <template v-for="(process,index) in flow.processes">
                                        <hr class="mt-3 mb-5" />
                                        <div class="row align-items-end">
                                            <div class="col">
                                                <ul class="list-group">
                                                    <li class="list-group-item active"><h5>Machine/Equipment</h5></li>
                                                    <li v-for="(item,eqp_index) in process.MachineEqp" class="list-group-item">

                                                        <div class="input-group mb-3">
                                                            <input type="text" class="form-control" v-model="process.MachineEqp[eqp_index]">
                                                            <div class="input-group-append" v-if="process.MachineEqp.length > 1">
                                                                <button class="btn btn-outline-danger btn-xs" type="button" @@click="process.MachineEqp.splice(eqp_index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                            </div>
                                                        </div>

                                                    </li>
                                                    <li class="list-group-item">
                                                        <button type="button" class="btn btn-xs btn-block btn-info" @@click="process.MachineEqp.push('')"><i class="fa fa-plus-circle"></i> Add</button>
                                                    </li>

                                                </ul>
                                            </div>
                                            <div class="col">
                                                <div class="row">
                                                    <div class="col">
                                                        <h1 class="text-primary">
                                                            <i class="fa-solid fa-arrow-turn-down fa-2x"></i>
                                                        </h1>

                                                    </div>
                                                    <div class="col text-right">
                                                        <h1 class="text-primary">
                                                            <i class="fa-solid fa-arrow-turn-up  fa-rotate-180  fa-2x"></i>
                                                        </h1>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <ul class="list-group">
                                                    <li class="list-group-item active"><h5>Man</h5></li>

                                                    <li v-for="(item,man_index) in process.Man" class="list-group-item">

                                                        <div class="input-group mb-3">
                                                            <input type="text" class="form-control" v-model="process.Man[man_index]">
                                                            <div class="input-group-append" v-if="process.Man.length > 1">
                                                                <button class="btn btn-outline-danger btn-xs" type="button" @@click="process.Man.splice(man_index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                            </div>
                                                        </div>

                                                    </li>
                                                    <li class="list-group-item">
                                                        <button type="button" class="btn btn-xs btn-block btn-info" @@click="process.Man.push('')"><i class="fa fa-plus-circle"></i> Add</button>
                                                    </li>

                                                </ul>
                                            </div>
                                        </div>
                                        
                                        <br />
                                        <div class="row align-items-center">
                                            <div class="col">
                                                <ul class="list-group">
                                                    <li class="list-group-item active"><h5>Input</h5></li>
                                                    <li v-for="(item,input_index) in process.Input" class="list-group-item">

                                                        <div class="input-group mb-3">
                                                            <input type="text" class="form-control" v-model="process.Input[input_index]">
                                                            <div class="input-group-append" v-if="process.Input.length > 1">
                                                                <button class="btn btn-outline-danger btn-xs" type="button" @@click="process.Input.splice(input_index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                            </div>
                                                        </div>

                                                    </li>
                                                    <li class="list-group-item">
                                                        <button type="button" class="btn btn-xs btn-block btn-info" @@click="process.Input.push('')"><i class="fa fa-plus-circle"></i> Add</button>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="col ">
                                                <div class="row align-items-center">
                                                    <div class="col-auto  ">

                                                        <h1 class="text-primary">
                                                            <i class="fa-solid fa-arrow-right fa-beat fa-xl"></i>
                                                        </h1>
                                                    </div>
                                                    <div class="col text-center p-0">
                                                        <div class="alert alert-primary p-3" role="alert">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <h4 class="pt-2">Process name</h4>
                                                                </div>
                                                                <div class="col-auto" v-if=" flow.processes.length > 1">
                                                                    <button class="btn btn-danger" @@click="flow.processes.splice(index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                                </div>
                                                            </div>
                                                           
                                                            <br />
                                                            <input class="form-control" type="text" v-model="process.processName" />
                                                            @*<h5 class="card-subtitle">Wastewater Treatment</h5>*@
                                                        </div>

                                                    </div>
                                                    <div class="col-auto ">
                                                        <h1 class="text-primary">
                                                            <i class="fa-solid fa-arrow-right fa-beat fa-xl"></i>
                                                        </h1>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="col">
                                                <ul class="list-group">
                                                    <li class="list-group-item active"><h5>Output</h5></li>
                                                    <li v-for="(item,output_index) in process.Output" class="list-group-item">

                                                        <div class="input-group mb-3">
                                                            <input type="text" class="form-control" v-model="process.Output[output_index]">
                                                            <div class="input-group-append" v-if="process.Output.length > 1">
                                                                <button class="btn btn-outline-danger btn-xs" type="button" @@click="process.Output.splice(output_index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                            </div>
                                                        </div>

                                                    </li>
                                                    <li class="list-group-item">
                                                        <button type="button" class="btn btn-xs btn-block btn-info" @@click="process.Output.push('')"><i class="fa fa-plus-circle"></i> Add</button>
                                                    </li>

                                                </ul>
                                            </div>
                                        </div>
                                        <br />
                                        <div class="row align-items-start">
                                            <div class="col">
                                                <ul class="list-group">
                                                    <li class="list-group-item active"><h5>Method</h5></li>
                                                    <li v-for="(item,method_index) in process.Method" class="list-group-item">

                                                        <div class="input-group mb-3">
                                                            <input type="text" class="form-control" v-model="process.Method[method_index]">
                                                            <div class="input-group-append" v-if="process.Method.length > 1">
                                                                <button class="btn btn-outline-danger btn-xs" type="button" @@click="process.Method.splice(method_index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                            </div>
                                                        </div>

                                                    </li>
                                                    <li class="list-group-item">
                                                        <button type="button" class="btn btn-xs btn-block btn-info" @@click="process.Method.push('')"><i class="fa fa-plus-circle"></i> Add</button>
                                                    </li>

                                                </ul>
                                            </div>
                                            <div class="col">
                                                <div class="row">
                                                    <div class="col">
                                                        <h1 class="text-primary">
                                                            <i class="fa-solid fa-arrow-turn-up fa-2x"></i>
                                                        </h1>

                                                    </div>
                                                    <div class="col text-right">
                                                        <h1 class="text-primary">
                                                            <i class="fa-solid fa-arrow-turn-down  fa-rotate-180  fa-2x"></i>
                                                        </h1>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <ul class="list-group">
                                                    <li class="list-group-item active"><h5>Control/Measurement</h5></li>
                                                    <li v-for="(item,ctrl_index) in process.Control" class="list-group-item">

                                                        <div class="input-group mb-3">
                                                            <input type="text" class="form-control" v-model="process.Control[ctrl_index]">
                                                            <div class="input-group-append" v-if="process.Control.length > 1">
                                                                <button class="btn btn-outline-danger btn-xs" type="button" @@click="process.Control.splice(ctrl_index,1)"><i class="fa-solid fa-circle-xmark"></i></button>
                                                            </div>
                                                        </div>

                                                    </li>
                                                    <li class="list-group-item">
                                                        <button type="button" class="btn btn-xs btn-block btn-info" @@click="process.Control.push('')"><i class="fa fa-plus-circle"></i> Add</button>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>

                                        @*<hr class="mt-5 mb-5" v-if="flow.processes.length >1" />*@
                                    </template>
                                    <br />
                                    <button type="button" class="btn btn-block btn-primary" @@click="flow.processes.push(JSON.parse(JSON.stringify(empty_process)))">Add Process Identification</button>

                                </div>
                                <div id="test-nlf-3" role="tabpanel" class="bs-stepper-pane fade text-center" aria-labelledby="stepper3trigger3">
                                    <button type="submit" class="btn btn-success mt-5">Save changes</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    


</div>
@section Scripts{
    <partial name="_Vue2" />
    <script>
        $(document).ready(function () {

            var stepper3 = new Stepper(document.querySelector('#stepper3'), {
                linear: false,
                animation: true
            })

            
            bsCustomFileInput.init()
            var output = document.getElementById('img_pre');
            console.log(output)
            imgInp = document.getElementById('inputGroupFile04');
            imgInp.onchange = evt => {
                $('#img_col').show()
                const [file] = imgInp.files
                if (file) {
                    output.src = URL.createObjectURL(file)
                }
            }
        })

        new Vue({
            el: '#app',
            components: {

            },
            data: {
                flow:{
                    flowId:null,
                    flowName:'',
                    division:'',
                    section:'',
                    attach_file:{

                    },
                    processes:[
                        {
                            processName:'',
                            MachineEqp: [''],
                            Man: [''],
                            Method: [''],
                            Control: [''],
                            Input: [''],
                            Output: ['']
                        }
                    ]
                },
                empty_process:{
                    processName: '',
                    MachineEqp: [''],
                    Man: [''],
                    Method: [''],
                    Control: [''],
                    Input: [''],
                    Output: ['']
                }
            }, 
            methods: {

            }
        })
    </script>
}